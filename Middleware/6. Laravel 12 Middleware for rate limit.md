You can **limit the register API to 3 attempts per hour** using Laravelâ€™s built-in **Rate Limiter** (no need for external packages).

Below is the **cleanest and recommended** method for Laravel API + Sanctum.

---

# âœ… **Step 1: Create a Custom Rate Limiter (3 requests per hour)**

Open:

```
app/Providers/RouteServiceProvider.php
```

Add this inside `boot()`:

```php
use Illuminate\Cache\RateLimiting\Limit;
use Illuminate\Support\Facades\RateLimiter;

public function boot(): void
{
    RateLimiter::for('register-limit', function ($request) {
        return [
            Limit::perHour(3)->by($request->ip())
        ];
    });
}
```

### âœ” What this does?

* Allows **only 3 register attempts per hour**
* Rate limit is tracked based on **IP address**

---

# âœ… **Step 2: Apply the middleware to the register API route**

Open:

```
routes/api.php
```

Use the limiter name: `register-limit`

```php
Route::post('/register', [AuthController::class, 'register'])
    ->middleware('throttle:register-limit');
```

---

# âœ… **Done! Now your register API is limited to 3 requests per hour**

If someone tries more, Laravel will return:

```
429 Too Many Attempts
```

With JSON:

```json
{
  "message": "Too Many Attempts."
}
```

---

# â­ OPTIONAL: Limit per user (if logged in) + per IP fallback

If you want the limit based on **user ID when logged in**, and **IP when not logged in**:

```php
RateLimiter::for('register-limit', function ($request) {
    $key = $request->user()?->id ?? $request->ip();

    return [
        Limit::perHour(3)->by($key)
    ];
});
```

---

# â­ OPTIONAL: Limit only by email field

```php
RateLimiter::for('register-limit', function ($request) {
    return [
        Limit::perHour(3)->by($request->email)
    ];
});
```

---

# ðŸŽ‰ Thatâ€™s it!

If you want, I can write:

* Full working code with AuthController
* Middleware + custom response
* Logging of blocked attempts
* Tracking attempt count in database

Just tell me!
