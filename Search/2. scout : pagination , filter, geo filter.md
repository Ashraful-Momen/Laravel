Perfect. Here’s a **short, practical guide** to make your **Order search production-ready** with **Laravel Scout + Typesense**, including **filters, pagination, and geo search**.

---

## 1. Filtering by price (or any field)

Update your controller search:

```php
public function search(Request $request)
{
    $query = $request->q;
    $minPrice = $request->min_price;
    $maxPrice = $request->max_price;

    $orders = Order::search($query)
        ->where('price', '>=', $minPrice ?? 0)
        ->where('price', '<=', $maxPrice ?? 1000000)
        ->get();

    return response()->json($orders);
}
```

> Scout supports simple filters like `where('field', operator, value)`.

---

## 2. Pagination

```php
$perPage = $request->per_page ?? 20;
$page    = $request->page ?? 1;

$orders = Order::search($query)
    ->paginate($perPage, 'page', $page);

return response()->json($orders);
```

Scout automatically handles pagination **via Typesense** and returns metadata:

```json
{
  "data": [...],
  "current_page": 1,
  "per_page": 20,
  "total": 150
}
```

---

## 3. Geo search (if your orders have location)

### Step 1: Add latitude & longitude to `Order` model

```php
protected $fillable = [
    'name', 'description', 'price', 'latitude', 'longitude'
];
```

### Step 2: Include location in `toSearchableArray()`

```php
public function toSearchableArray()
{
    return [
        'id' => (string) $this->id,
        'name' => $this->name,
        'description' => $this->description,
        'price' => $this->price,
        'location' => [
            $this->latitude,
            $this->longitude
        ],
    ];
}
```

### Step 3: Query nearby orders

```php
$lat = $request->lat;
$lng = $request->lng;
$radius = $request->radius ?? 5000; // meters

$orders = Order::search($query)
    ->around($lat, $lng)
    ->withinRadius($radius)
    ->get();
```

---

## 4. Combined example (search + filter + pagination + geo)

```php
$orders = Order::search($request->q)
    ->where('price', '>=', $request->min_price ?? 0)
    ->where('price', '<=', $request->max_price ?? 1000000)
    ->around($request->lat, $request->lng)
    ->withinRadius($request->radius ?? 5000)
    ->paginate($request->per_page ?? 20, 'page', $request->page ?? 1);
```

---

## 5. Tips for production-ready search

1. **Index only searchable fields** in `toSearchableArray()`.
2. **Use queues** for large data imports.
3. **Reindex on model update**: Scout handles this automatically.
4. **Use filters sparingly**: Typesense is fast but complex filters may affect speed.
5. **Add autocomplete** if needed:

   ```php
   Order::search($request->q, ['prefix' => true])->get();
   ```

---

### ✅ Summary

With this setup:

* Users can **search by name/description**
* **Filter by price**
* **See nearby orders on a map**
* **Paginate results**
* **Autocomplete supported**

Scout + Typesense handles all **search performance and relevance**, while Laravel remains the **source of truth**.

---

If you want, I can make a **full “ready-to-use OrderSearchController”** with **filters, geo search, pagination, and autocomplete**, so you can drop it directly into your project. Do you want me to do that?
